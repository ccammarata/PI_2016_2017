tempTable <- aggregate(accuracy~session, data=ABsummary, FUN=(sd))
ABsummaryTable<- as.data.frame(ABsummaryTable)
ABsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
ABsummaryTable$se <- tempTable$accuracy*100
ABsummaryTable$accuracy <- ABsummaryTable$accuracy * 100
#for full task
sessList <- list(27, 28, 29, 30)#list session nubmers here
ratList <- list(25,35,46,49,53,57,28,36,50,63,64)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate lesion condition of animals
sapGroup = list(28, 36,50,63,64)
conGroup = list(25,35,46,49,53,57)
FULLsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=5)
colnames(FULLsummary)<- c('ratID', 'session', 'AB_acc', 'AC_acc', 'DE_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
criteriaFilename <- paste("U3_CriteriaMet",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
FULLsummary[i,0:5] <- c(rat, sessNum, ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide and long form data frames for full task
FULLfinalSummaryW <- data.frame(FULLsummary)
#FULLfinalSummaryW$condition <- ifelse(is.element(FULLfinalSummaryW$ratID, sapGroup) ,'sap','control')
z = rowsNeeded*3
FULLfinalSummaryL <- reshape(FULLfinalSummaryW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
FULLfinalSummaryL$ratID <-as.factor(FULLfinalSummaryL$ratID)
FULLfinalSummaryL$session <-as.factor(FULLfinalSummaryL$session)
FULLfinalSummaryL$trialType <- as.factor(FULLfinalSummaryL$trialType)
FULLfinalSummaryW$ratID <-as.factor(FULLfinalSummaryW$ratID)
FULLfinalSummaryW$session <-as.factor(FULLfinalSummaryW$session)
#making summary table for full task
FULLsummaryTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(sd))
FULLsummaryTable<- as.data.frame(FULLsummaryTable)
FULLsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
FULLsummaryTable$se <- tempTable$accuracy*100
FULLsummaryTable$accuracy <- FULLsummaryTable$accuracy * 100
#part 1 - AB acquisition
#check distribution
describe(ABsummary)
hist(ABsummary$accuracy)
#distribution is actually a bit strange, though all above chance - also pretty small number of rats
plot(accuracy~session, data=ABsummary)
mean(ABsummary$accuracy)
# no interesting results, though by the end of the first session the group average was almost 80% accuracy
#part 2 - full task
describe(FULLfinalSummaryW)
describe(FULLfinalSummaryL)
hist(FULLfinalSummaryL$accuracy)
#accuracy for the full task is normally distributed
plot(accuracy~session, data=FULLfinalSummaryL)
#looks like session didn't ahve much effect
p1= ggplot(data=FULLfinalSummaryL, aes(trialType,accuracy))
p1+geom_boxplot(aes(fill=trialType)) +
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("Cavalcanti"))+
guides(fill=guide_legend(title="trial type"))
#inferential tests of full task
qqnorm(FULLfinalSummaryL$accuracy)
qqline(FULLfinalSummaryL$accuracy) #to check for normality of residuals
aov1 <- ezANOVA(data=FULLfinalSummaryL, dv=accuracy, wid = ratID,within=c(trialType,session),detailed=TRUE,return_aov = TRUE)
aov1$`Mauchly's Test for Sphericity` #to quckly check sphericity, which is fine in this case
#I used ezANOVA to get the sphericity test but I can't figure out how to do post hoc analyses with that output
aov2 <- aov_ez("ratID","accuracy",data=FULLfinalSummaryL,within = c("trialType","session"))
summary(aov2)
lsmeans(aov2, "trialType", contr = "pairwise", adjust = "holm")
setwd("~/GitHub/PI_2016_2017/PI_with_drugs")
options(contrasts=c("contr.sum", "contr.poly"))
setwd("~/GitHub/PI_2016_2017/PI_with_drugs")
library(foreign)
library(psych)
library(reshape2)
library(ggplot2)
library(car)
library(ez)
library(Rmisc)
library(gmodels)
library(wesanderson)
library(afex)
#list rat number here
ratList <- list(28, 36,50,63,64,25,35,46,49,53,57)
#to indicate lesion condition of animals
sapGroup = list(28, 36,50,63,64)
conGroup = list(25,35,46,49,53,57)
#make a data frame for the AB acquisition days
sessList <- list(35,36,37,43,44,45)#list session nubmers here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#making an empty matrix
AB_acquisition <- matrix(data = NA, nrow = rowsNeeded, ncol=4)
colnames(AB_acquisition)<- c('ratID', 'session', 'task','accuracy')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
AB_acquisition[i,0:4] <- c(rat, sessNum, 'AB_aq', ABacc)
i=i+1
}
}
#making the matrix into a data frame and adding lesion condition
AB_acquisitionW <- data.frame(AB_acquisition) #making it into a data frame
AB_acquisitionW$ratID <- factor(AB_acquisitionW$ratID) #making rat number a factor
#AB_acquisitionW$condition <- ifelse(is.element(AB_acquisitionW$ratID, sapGroup) ,'sap','control') #adding lesion condition
AB_acquisitionW$accuracy <- as.character(AB_acquisitionW$accuracy)
AB_acquisitionW$accuracy <- as.numeric(AB_acquisitionW$accuracy)
ABsummaryTable <- aggregate(accuracy~session, data=AB_acquisitionW, FUN=(mean))
tempTable <- aggregate(accuracy~session, data=AB_acquisition, FUN=(sd))
ABsummaryTable<- as.data.frame(ABsummaryTable)
ABsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
ABsummaryTable$se <- tempTable$accuracy*100
ABsummaryTable$accuracy <- ABsummaryTable$accuracy * 100
#make a data frame for the full task days
sessList <- list(38,39,40,41,46,47,48,49)#list session nubmers here
##!!## note that I am ignoring the 5th day of round 1
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate drug condition by day
drug1First <- list(25,28,46,50,53,64)#here I'll enter the ID numbers of the animlas that had drug 1 first; all others had drug 2 first
firstWeek <- list(38,39,40,41)
#making an empty matrix
summary <- matrix(data = NA, nrow = rowsNeeded, ncol=6)
colnames(summary)<- c('ratID', 'session', 'task', 'AB_acc', 'AC_acc', 'DE_acc')
criteriaOverview <- matrix(data = NA, nrow = rowsNeeded, ncol=2)
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
summary[i,0:6] <- c(rat, sessNum, 'fullTask',ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide form data frames
fullTaskW <- data.frame(summary) #making it into a data frame
fullTaskW$AB_acc <- as.character(fullTaskW$AB_acc)
fullTaskW$AB_acc <- as.numeric(fullTaskW$AB_acc)
fullTaskW$AC_acc <- as.character(fullTaskW$AC_acc)
fullTaskW$AC_acc <- as.numeric(fullTaskW$AC_acc)
fullTaskW$DE_acc <- as.character(fullTaskW$DE_acc)
fullTaskW$DE_acc <- as.numeric(fullTaskW$DE_acc)
#fullTaskW$condition <- ifelse(is.element(fullTaskW$ratID, sapGroup) ,'sap','control') #adding lesion condition
fullTaskW$round <- recode(fullTaskW$session, "c(38,39,40,41)='round1';else='round2'")
fullTaskW$drug <- ifelse(is.element(fullTaskW$ratID,drug1First),
ifelse(fullTaskW$round=='round1','drug1','drug2'),
ifelse(fullTaskW$round=='round1','drug2','drug1'))
fullTaskW$drug <- factor(fullTaskW$drug)
fullTaskW$day <- recode(fullTaskW$session, "c(38,46)='full1';c(39,47)='full2';c(40,48)='full3';c(41,49)='full4'")
#fullTaskW$condition <- factor(fullTaskW$condition)
#making a long form data set
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
summaryTable <- aggregate(accuracy~trialType, data=fullTaskL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType, data=fullTaskL, FUN=(sd))
summaryTable<- as.data.frame(summaryTable)
summaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
summaryTable$se <- tempTable$accuracy*100
summaryTable$accuracy <- summaryTable$accuracy * 100
# analysis if AB acquisition
hist(AB_acquisitionW$accuracy)
describe(AB_acquisitionW)
plot(accuracy~session, data=AB_acquisitionW)
#doesn't indicate systamatic change over the days
#in both rounds they learned the pair withing the fist dat, although they
#didn't do as well on the first day of the first pair
#anlaysis of full task
hist(fullTaskL$accuracy)
describe(fullTaskL)
describe(fullTaskW)
qqnorm(fullTaskL$accuracy)
qqline(fullTaskL$accuracy)
#normality of residuals seems fine
anova1 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","round","trialType"))
p1= ggplot(data=fullTaskL, aes(trialType, accuracy))
p1+geom_boxplot(aes(col=trialType))+facet_grid(round ~ .)
#doing an ANOVA to check sphericity/HOV
aov2 <- ezANOVA(data=fullTaskL, dv=accuracy, wid = ratID,within=c(trialType,day,drug), detailed=TRUE,return_aov = TRUE)
aov2$`Mauchly's Test for Sphericity` #sphericity not significant
anova2 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","drug","trialType"))
summary(anova2)#only significant effect is trial type; highly significant
lsmeans(anova2, "trialType", contr = "pairwise", adjust = "holm")#significant differences between AB vs. Ca and DE vs. Ca
p2= ggplot(data=fullTaskL, aes(trialType, accuracy))
p2+geom_boxplot(aes(fill=trialType))+facet_grid(drug ~ .)+
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type and drug") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("Cavalcanti"))+
guides(fill=guide_legend(title="trial type"))
View(AB_acquisitionW)
View(ABsummaryTable)
median(AB_acquisitionW$accuracy)
View(ABsummaryTable)
setwd("~/GitHub/PI_2016_2017/PI_with_drugs")
# PI full task analysis
library(foreign)
library(psych)
library(reshape2)
library(ggplot2)
library(Rmisc)
library(gmodels)
library(wesanderson)
library(afex)
library(car)
library(phia)
#list rat number here
ratList <- list(28, 36,50,63,64,25,35,46,49,53,57)
#to indicate lesion condition of animals
sapGroup = list(28, 36,50,63,64)
conGroup = list(25,35,46,49,53,57)
#make a data frame for the AB acquisition days
sessList <- list(35,36,37,43,44,45)#list session nubmers here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#making an empty matrix
AB_acquisition <- matrix(data = NA, nrow = rowsNeeded, ncol=4)
colnames(AB_acquisition)<- c('ratID', 'session', 'task',' AB_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
#sliding window criteria?
AB_acquisition[i,0:4] <- c(rat, sessNum, 'AB_aq', ABacc)
i=i+1
}
}
#making the matrix into a data frame and adding lesion condition
AB_acquisitionW <- data.frame(AB_acquisition) #making it into a data frame
AB_acquisitionW$ratID <- factor(AB_acquisitionW$ratID) #making rat number a factor
AB_acquisitionW$condition <- ifelse(is.element(AB_acquisitionW$ratID, sapGroup) ,'sap','control') #adding lesion condition
###!!!### make the accuracy values character and then numeric
#make a data frame for the full task days
sessList <- list(38,39,40,41,46,47,48,49)#list session nubmers here
##!!## note that I am ignoring the 5th day of round 1
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate drug condition by day
drug1First <- list(25,28,46,50,53,64)#here I'll enter the ID numbers of the animlas that had drug 1 first; all others had drug 2 first
firstWeek <- list(38,39,40,41)
#making an empty matrix
summary <- matrix(data = NA, nrow = rowsNeeded, ncol=6)
colnames(summary)<- c('ratID', 'session', 'task', 'AB_acc', 'AC_acc', 'DE_acc')
criteriaOverview <- matrix(data = NA, nrow = rowsNeeded, ncol=2)
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
summary[i,0:6] <- c(rat, sessNum, 'fullTask',ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide form data frames
fullTaskW <- data.frame(summary) #making it into a data frame
fullTaskW$AB_acc <- as.character(fullTaskW$AB_acc)
fullTaskW$AB_acc <- as.numeric(fullTaskW$AB_acc)
fullTaskW$AC_acc <- as.character(fullTaskW$AC_acc)
fullTaskW$AC_acc <- as.numeric(fullTaskW$AC_acc)
fullTaskW$DE_acc <- as.character(fullTaskW$DE_acc)
fullTaskW$DE_acc <- as.numeric(fullTaskW$DE_acc)
fullTaskW$condition <- ifelse(is.element(fullTaskW$ratID, sapGroup) ,'sap','control') #adding lesion condition
fullTaskW$round <- recode(fullTaskW$session, "c(38,39,40,41)='round1';else='round2'")
fullTaskW$drug <- ifelse(is.element(fullTaskW$ratID,drug1First),
ifelse(fullTaskW$round=='round1','drug1','drug2'),
ifelse(fullTaskW$round=='round1','drug2','drug1'))
fullTaskW$drug <- factor(fullTaskW$drug)
fullTaskW$day <- recode(fullTaskW$session, "c(38,46)='full1';c(39,47)='full2';c(40,48)='full3';c(41,49)='full4'")
fullTaskW$condition <- factor(fullTaskW$condition)
#making a long form data set
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
#calculating difference scores in wide data frame
fullTaskW$PI_effect <- fullTaskW$DE_acc - fullTaskW$AC_acc
fullTaskW$AB_CA_diff <- fullTaskW$AB_acc - fullTaskW$AC_acc
#fullTaskW$AB_DE_diff <- fullTaskW$AB_acc - fullTaskW$DE_acc
#confirm data frames look right
str(AB_acquisitionW)
str(fullTaskW)
str(fullTaskL)
xtabs(~ drug+round, data=fullTaskW)
aggregate(accuracy~trialType+drug+condition, data=fullTaskL, FUN=(mean))
#summary tables for making certain plots
summaryTable <- aggregate(accuracy~trialType+day+condition, data=fullTaskL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType+day, data=fullTaskL, FUN=(sd))
summaryTable<- as.data.frame(summaryTable)
summaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
summaryTable$se <- tempTable$accuracy*100
summaryTable$accuracy <- summaryTable$accuracy * 100
#checking how accuracies are distributed
hist(fullTaskL$accuracy)
#exploratory plots
p1= ggplot(data=fullTaskL, aes(day, accuracy))
p1+geom_boxplot(aes(col=trialType))
p2= ggplot(data=fullTaskL, aes(drug, accuracy))
p2+geom_boxplot(aes(col=trialType))
p3= ggplot(data=fullTaskL, aes(condition, accuracy))
p3+geom_boxplot(aes(col=trialType))
p4= ggplot(data=fullTaskL, aes(round, accuracy))
p4+geom_boxplot(aes(col=trialType))
p4.1= ggplot(data=fullTaskL, aes(round, accuracy))
p4.1+geom_boxplot(aes(col=trialType))+facet_grid(drug ~ .)
p5= ggplot(data=fullTaskL, aes(day, accuracy))
p5+geom_boxplot(aes(col=trialType))+facet_grid(drug ~ .)
p6= ggplot(data=fullTaskL, aes(day, accuracy))
p6+geom_boxplot(aes(col=trialType))+facet_grid(condition ~ drug)
#inferential stats
anova1 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","drug","trialType"),
between = c("condition"))
summary(anova1)
AC_DE_only <- subset(fullTaskL, trialType != "AB")
a2 <- aov_ez("ratID","accuracy",AC_DE_only, within = c("day","drug","trialType"),
between = c("condition"))
summary(a2)
#even if I'm only looking at AC vs. DE, there is a significant effect of trialType
#shows a significant main effect for trial type, and a significant 4 way interaction
#no 3 way interaction (not significant if you don't count the day)
#should do simple main effects - I first am intersted in whether there is a
# 3 way interaction in any of the days
#to explore the significant main effect of trialType, pairwise comparisons to see what's
#driving the difference - using adjusted p values
lsmeans(anova1, "trialType", contr = "pairwise", adjust = "holm")
#shows that CA is significantly lower than either of the other two - in particular it's much
#lower then AB, but there is no significant difference between AB and DE
lsmeans(anova1, "day", contr = "pairwise", adjust = "holm")
#probing the interaction in a few ways
#coarse simple main effect of trialType at each level of condition
testInteractions(anova1$lm, across="trialType",fixed=c("condition"),idata=anova1$Anova$idata)
#suggests that the effect of trialType was only significant for the controls, marginally
#significant for the sap rats
#finer simple main effect by condition and drug
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata)
#suggests that trialType only had a significan effect during drug 1, but both lesion condition
#did have it then
setwd("~/GitHub/PI_2016_2017/PI_drug_free_Oct2016")
options(contrasts=c("contr.sum", "contr.poly"))
library(foreign)
library(psych)
library(reshape2)
library(ggplot2)
library(car)
library(ez)
library(Rmisc)
library(gmodels)
library(wesanderson)
library(afex)
# for AB acquisition
sessList <- list(23,24,25)#list session nubmers here
ratList <- list(25,35,46,49,53,57,28,36,50,63,64)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate lesion condition of animals
sapGroup = list(28,36,50,63,64)
conGroup = list(25,35,46,49,53,57)
ABsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=3)
colnames(ABsummary)<- c('ratID', 'session', 'accuracy')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
criteriaFilename <- paste("U3_CriteriaMet",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
ABsummary[i,0:3] <- c(rat, sessNum, ABacc)
i=i+1
}
}
ABsummary <- data.frame(ABsummary)
ABsummary$ratID <- as.factor(ABsummary$ratID)
ABsummary$session <- as.factor(ABsummary$session)
#ABsummary$condition <- ifelse(is.element(ABsummary$ratID, sapGroup) ,'sap','control')
ABsummaryTable <- aggregate(accuracy~session, data=ABsummary, FUN=(mean))
tempTable <- aggregate(accuracy~session, data=ABsummary, FUN=(sd))
ABsummaryTable<- as.data.frame(ABsummaryTable)
ABsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
ABsummaryTable$se <- tempTable$accuracy*100
ABsummaryTable$accuracy <- ABsummaryTable$accuracy * 100
#for full task
sessList <- list(27, 28, 29, 30)#list session nubmers here
ratList <- list(25,35,46,49,53,57,28,36,50,63,64)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate lesion condition of animals
sapGroup = list(28, 36,50,63,64)
conGroup = list(25,35,46,49,53,57)
FULLsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=5)
colnames(FULLsummary)<- c('ratID', 'session', 'AB_acc', 'AC_acc', 'DE_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
criteriaFilename <- paste("U3_CriteriaMet",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
FULLsummary[i,0:5] <- c(rat, sessNum, ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide and long form data frames for full task
FULLfinalSummaryW <- data.frame(FULLsummary)
#FULLfinalSummaryW$condition <- ifelse(is.element(FULLfinalSummaryW$ratID, sapGroup) ,'sap','control')
z = rowsNeeded*3
FULLfinalSummaryL <- reshape(FULLfinalSummaryW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
FULLfinalSummaryL$ratID <-as.factor(FULLfinalSummaryL$ratID)
FULLfinalSummaryL$session <-as.factor(FULLfinalSummaryL$session)
FULLfinalSummaryL$trialType <- as.factor(FULLfinalSummaryL$trialType)
FULLfinalSummaryW$ratID <-as.factor(FULLfinalSummaryW$ratID)
FULLfinalSummaryW$session <-as.factor(FULLfinalSummaryW$session)
#making summary table for full task
FULLsummaryTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(sd))
FULLsummaryTable<- as.data.frame(FULLsummaryTable)
FULLsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
FULLsummaryTable$se <- tempTable$accuracy*100
FULLsummaryTable$accuracy <- FULLsummaryTable$accuracy * 100
#part 1 - AB acquisition
#check distribution
describe(ABsummary)
hist(ABsummary$accuracy)
#distribution is actually a bit strange, though all above chance - also pretty small number of rats
plot(accuracy~session, data=ABsummary)
mean(ABsummary$accuracy)
# no interesting results, though by the end of the first session the group average was almost 80% accuracy
#part 2 - full task
describe(FULLfinalSummaryW)
describe(FULLfinalSummaryL)
hist(FULLfinalSummaryL$accuracy)
#accuracy for the full task is normally distributed
plot(accuracy~session, data=FULLfinalSummaryL)
#looks like session didn't ahve much effect
p1= ggplot(data=FULLfinalSummaryL, aes(trialType,accuracy))
p1+geom_boxplot(aes(fill=trialType)) +
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("Cavalcanti"))+
guides(fill=guide_legend(title="trial type"))
#inferential tests of full task
qqnorm(FULLfinalSummaryL$accuracy)
qqline(FULLfinalSummaryL$accuracy) #to check for normality of residuals
aov1 <- ezANOVA(data=FULLfinalSummaryL, dv=accuracy, wid = ratID,within=c(trialType,session),detailed=TRUE,return_aov = TRUE)
aov1$`Mauchly's Test for Sphericity` #to quckly check sphericity, which is fine in this case
#I used ezANOVA to get the sphericity test but I can't figure out how to do post hoc analyses with that output
aov2 <- aov_ez("ratID","accuracy",data=FULLfinalSummaryL,within = c("trialType","session"))
summary(aov2)
lsmeans(aov2, "trialType", contr = "pairwise", adjust = "holm")
