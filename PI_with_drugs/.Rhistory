setwd("C:/Users/aka47-l2/Downloads/PI_with_drgus (1)/PI_with_drgus/PI_with_drgus")
library(foreign)
library(psych)
library(reshape2)
library(ggplot2)
#library(car) might not need this if I'm using afex
library(Rmisc)
library(gmodels)
library(wesanderson)
library(afex)
library(car)
library(phia)
#list rat number here
ratList <- list(28, 36,50,63,64,25,35,46,49,53,57)
#to indicate lesion condition of animals
sapGroup = list(28, 36,50,63,64)
conGroup = list(25,35,46,49,53,57)
#make a data frame for the AB acquisition days
sessList <- list(35,36,37,43,44,45)#list session nubmers here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#making an empty matrix
AB_acquisition <- matrix(data = NA, nrow = rowsNeeded, ncol=4)
colnames(AB_acquisition)<- c('ratID', 'session', 'task',' AB_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
#sliding window criteria?
AB_acquisition[i,0:4] <- c(rat, sessNum, 'AB_aq', ABacc)
i=i+1
}
}
#making the matrix into a data frame and adding lesion condition
AB_acquisitionW <- data.frame(AB_acquisition) #making it into a data frame
AB_acquisitionW$ratID <- factor(AB_acquisitionW$ratID) #making rat number a factor
AB_acquisitionW$condition <- ifelse(is.element(AB_acquisitionW$ratID, sapGroup) ,'sap','control') #adding lesion condition
sessList <- list(38,39,40,41,46,47,48,49)#list session nubmers here
##!!## note that I am ignoring the 5th day of round 1
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
#to indicate drug condition by day
drug1First <- list(25,28,46,50,53,64)#here I'll enter the ID numbers of the animlas that had drug 1 first; all others had drug 2 first
firstWeek <- list(38,39,40,41)
#making an empty matrix
summary <- matrix(data = NA, nrow = rowsNeeded, ncol=6)
colnames(summary)<- c('ratID', 'session', 'task', 'AB_acc', 'AC_acc', 'DE_acc')
criteriaOverview <- matrix(data = NA, nrow = rowsNeeded, ncol=2)
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
summary[i,0:6] <- c(rat, sessNum, 'fullTask',ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide form data frames
fullTaskW <- data.frame(summary) #making it into a data frame
fullTaskW$AB_acc <- as.character(fullTaskW$AB_acc)
fullTaskW$AB_acc <- as.numeric(fullTaskW$AB_acc)
fullTaskW$AC_acc <- as.character(fullTaskW$AC_acc)
fullTaskW$AC_acc <- as.numeric(fullTaskW$AC_acc)
fullTaskW$DE_acc <- as.character(fullTaskW$DE_acc)
fullTaskW$DE_acc <- as.numeric(fullTaskW$DE_acc)
fullTaskW$condition <- ifelse(is.element(fullTaskW$ratID, sapGroup) ,'sap','control') #adding lesion condition
fullTaskW$round <- recode(fullTaskW$session, "c(38,39,40,41)='round1';else='round2'")
fullTaskW$drug <- ifelse(is.element(fullTaskW$ratID,drug1First),
ifelse(fullTaskW$round=='round1','drug1','drug2'),
ifelse(fullTaskW$round=='round1','drug2','drug1'))
fullTaskW$drug <- factor(fullTaskW$drug)
fullTaskW$day <- recode(fullTaskW$session, "c(38,46)='full1';c(39,47)='full2';c(40,48)='full3';c(41,49)='full4'")
#making a long form data set
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
#calculating difference scores in wide data frame
fullTaskW$PI_effect <- fullTaskW$DE_acc - fullTaskW$AC_acc
summaryTable <- aggregate(accuracy~trialType+day+condition, data=fullTaskL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType+day, data=fullTaskL, FUN=(sd))
summaryTable<- as.data.frame(summaryTable)
summaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
summaryTable$se <- tempTable$accuracy*100
summaryTable$accuracy <- summaryTable$accuracy * 100
p2.1 = ggplot(data=fullTaskL, aes(colour=drug, y=accuracy,x=trialType))
p2.1 + geom_line(aes(group=group))
p2.1 = ggplot(data=fullTaskL, aes(colour=drug, y=accuracy,x=trialType))
p2.1 + geom_line(aes(group=drug))
p2.1 = ggplot(data=fullTaskL, aes(colour=drug, y=accuracy,x=trialType))
p2.1 + geom_line(aes(group=drug), position = dodge)
p2.1 + geom_line(aes(group=drug), position = dodge)
p2.1 + geom_line(aes(group=drug), position_dodge())
p2= ggplot(data=fullTaskL, aes(drug, accuracy))
p2+geom_boxplot(aes(col=trialType))
plot(trialType,accuracy)
plot(trialType,accuracy, data=fullTaskL)
plot(fullTaskL$trialType,fullTaskL$accuracy)
plot(fullTaskL$trialType,fullTaskL$accuracy, xlim = c(0,100))
plot(fullTaskL$trialType,fullTaskL$accuracy
p <- ggplot(fullTaskL, aes(y=accuracy, x=trialType))
p + geom_line(aes)
p + geom_line()
p + geom_point()
View(summaryTable)
p <- ggplot(summaryTable, aes(y=accuracy, x=trialType))
p + geom_point()
View(summary)
View(summaryTable)
p <- ggplot(summaryTable, aes(y=mean(accuracy), x=trialType))
p + geom_point()
p + geom_line()
anova1 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","drug","trialType"),
between = c("condition"))
summary(anova1)
?testInteractions
testInteractions(anova1,fixed = condition, across=c(day,trialType,drug), idata=anova1$Anova$idata)
testInteractions(anova1,fixed = condition, across=list(day,trialType,drug), idata=anova1$Anova$idata)
testInteractions(anova1,fixed = condition, idata=anova1$Anova$idata)
testInteractions(anova1, idata=anova1$Anova$idata)
anova1 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","drug","trialType"),
between = c("condition"))
fullTaskW$condition <- factor(fullTaskW$condition)
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
fullTaskW$PI_effect <- fullTaskW$DE_acc - fullTaskW$AC_acc
fullTaskW$PI_effect <- fullTaskW$DE_acc - fullTaskW$AC_acc
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
a2 <- aov_ex("ratID","PI_effect",fullTaskL, within = c("day","drug"),between = c("condition"))
a2 <- aov_ez("ratID","PI_effect",fullTaskL, within = c("day","drug"),between = c("condition"))
summary(a2)
fullTaskW$AB_CA_diff <- fullTaskW$AB_acc - fullTaskW$AC_acc
z = rowsNeeded*3
fullTaskL <- reshape(fullTaskW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
a2 <- aov_ez("ratID","AB_CA_diff",fullTaskL, within = c("day","drug"),between = c("condition"))
summary(a2)
summary(anova1)
PI_only <- subset(fullTaskL, trialType != "AB")
a2 <- aov_ez("ratID","accuracy",fullTaskL, within = c("day","drug","trialType"),
between = c("condition"))
summary(a2)
AC_DE_only <- subset(fullTaskL, trialType != "AB")
a2 <- aov_ez("ratID","accuracy",AC_DE_only, within = c("day","drug","trialType"),
between = c("condition"))
summary(a2)
testInteractions(anova1,idata=anova1$Anova$idata)
testInteractions(anova1)
testInteractions(anova1, idata=anova1$Anova$idata)
testInteractions(anova1, idata=anova1$idata)
testInteractions(anova1$lm, idata=anova1$Anova$idata)
testInteractions(anova1$lm, across=trialType,idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=list("day","drug","condition"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("day","drug","condition"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed="condition",idata=anova1$Anova$idata)
p3= ggplot(data=fullTaskL, aes(condition, accuracy))
p3+geom_boxplot(aes(col=trialType))
?table
?aggregate
aggregate(fullTaskL$accuracy, by=fullTaskL$condition)
aggregate(fullTaskL$accuracy, by=fullTaskL$condition, FUN="mean")
aggregate(fullTaskL$accuracy, by=list(fullTaskL$condition), FUN="mean")
aggregate(fullTaskL$accuracy, by=list(fullTaskL$condition, fullTaskL$trialType), FUN="mean")
aggregate(fullTaskL$accuracy, by=list(fullTaskL$trialType,fullTaskL$condition), FUN="mean")
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata)
View(fullTaskL)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug","day"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="condition",fixed=c("trialType","drug"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug","day"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","day"),idata=anova1$Anova$idata)
p6= ggplot(data=fullTaskL, aes(day, accuracy))
p6+geom_boxplot(aes(col=trialType))+facet_grid(condition ~ drug)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","day"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata)
testInteractions(anova1$lm, across="trialType",fixed=c("condition","drug"),idata=anova1$Anova$idata
)
testInteractions(anova1$lm, across="trialType",fixed=c("condition"),idata=anova1$Anova$idata)
